<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Estima del metabolismo del metabolismo aeróbico. | Prácticas de Limnología Aplicada</title>
  <meta name="description" content="En este documento abordaremos las prácticas de informática de la asignatura de Limnología Aplicada." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Estima del metabolismo del metabolismo aeróbico. | Prácticas de Limnología Aplicada" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="En este documento abordaremos las prácticas de informática de la asignatura de Limnología Aplicada." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Estima del metabolismo del metabolismo aeróbico. | Prácticas de Limnología Aplicada" />
  
  <meta name="twitter:description" content="En este documento abordaremos las prácticas de informática de la asignatura de Limnología Aplicada." />
  

<meta name="author" content="Jorge Juan Montes Pérez (jmontesp@uma.es)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descargar-los-datos-de-la-red-gleon.html"/>
<link rel="next" href="estabilidad-térmica-de-la-columna-de-agua..html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);

</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);

</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan, pre.js');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);

</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Limnología Aplicada</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>¿Cómo seguir la práctica?</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html#metabolismo-de-ecosistemas-acuáticos"><i class="fa fa-check"></i><b>1.1</b> Metabolismo de ecosistemas acuáticos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="estructura-de-la-práctica.html"><a href="estructura-de-la-práctica.html"><i class="fa fa-check"></i><b>2</b> Estructura de la práctica</a></li>
<li class="chapter" data-level="3" data-path="previsualización-de-los-datos.html"><a href="previsualización-de-los-datos.html"><i class="fa fa-check"></i><b>3</b> Previsualización de los datos</a></li>
<li class="chapter" data-level="4" data-path="descargar-los-datos-de-la-red-gleon.html"><a href="descargar-los-datos-de-la-red-gleon.html"><i class="fa fa-check"></i><b>4</b> Descargar los datos de la red GLEON</a></li>
<li class="chapter" data-level="5" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html"><i class="fa fa-check"></i><b>5</b> Estima del metabolismo del metabolismo aeróbico.</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#función-metab-del-paquete-lakemetabolizer"><i class="fa fa-check"></i><b>5.1</b> Función <code>metab()</code> del paquete LakeMetabolizer</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#concentración-de-oxígeno-en-saturación."><i class="fa fa-check"></i><b>5.1.1</b> Concentración de oxígeno en saturación.</a></li>
<li class="chapter" data-level="5.1.2" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#coeficiente-de-intercambio-gaseoso"><i class="fa fa-check"></i><b>5.1.2</b> Coeficiente de intercambio gaseoso</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#volvemos-a-la-función-metab"><i class="fa fa-check"></i><b>5.2</b> Volvemos a la función <code>metab()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estabilidad-térmica-de-la-columna-de-agua..html"><a href="estabilidad-térmica-de-la-columna-de-agua..html"><i class="fa fa-check"></i><b>6</b> Estabilidad térmica de la columna de agua.</a></li>
<li class="chapter" data-level="7" data-path="representación-gráfica.html"><a href="representación-gráfica.html"><i class="fa fa-check"></i><b>7</b> Representación gráfica</a>
<ul>
<li class="chapter" data-level="7.1" data-path="representación-gráfica.html"><a href="representación-gráfica.html#variables-físico-químicas"><i class="fa fa-check"></i><b>7.1</b> Variables físico-químicas</a></li>
<li class="chapter" data-level="7.2" data-path="representación-gráfica.html"><a href="representación-gráfica.html#estructura-térmica-del-lago."><i class="fa fa-check"></i><b>7.2</b> Estructura térmica del lago.</a></li>
<li class="chapter" data-level="7.3" data-path="representación-gráfica.html"><a href="representación-gráfica.html#resultados-del-metabolismo"><i class="fa fa-check"></i><b>7.3</b> Resultados del metabolismo</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="recopilamos.html"><a href="recopilamos.html"><i class="fa fa-check"></i><b>8</b> Recopilamos</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/" target="blank">Realizado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Limnología Aplicada</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estima-del-metabolismo-del-metabolismo-aeróbico." class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Estima del metabolismo del metabolismo aeróbico.<a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#estima-del-metabolismo-del-metabolismo-aeróbico." class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Una vez que hemos visualizado las variables de las que disponemos. Vamos a buscar un periodo que nos interese. En este caso nos vamos a fijar solamente en que estén los datos que necesitamos. Sin embargo, con el resto de variables podríamos explorar los datos y buscar un periodo de interés concreto en base a un evento particular (un verano muy caluroso, una época muy ventosa o un periodo de bajas presiones).</p>
<p>Primero vamos a cargar los datos de la sesión anterior.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importo los datos</span></span>
<span id="cb67-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb67-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Datos_descargados/Datos_Trout.csv&quot;</span>)</span>
<span id="cb67-3"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb67-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>sampledate <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(datos<span class="sc">$</span>sampledate)</span>
<span id="cb67-4"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Creamos una variable que integra la fecha y la hora</span></span>
<span id="cb67-5"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb67-5" aria-hidden="true" tabindex="-1"></a>  datetime <span class="ot">&lt;-</span> <span class="fu">paste</span>(datos<span class="sc">$</span>sampledate, datos<span class="sc">$</span>hour)</span>
<span id="cb67-6"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb67-6" aria-hidden="true" tabindex="-1"></a>  datos<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(datetime, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d %H&quot;</span>)</span></code></pre></div>
<p>Seleccionamos un subgrupo de datos en los que tengamos información de OD, temperatura del agua, velocidad del viento y radiación fotosintéticamente activa (PAR).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb68-1" aria-hidden="true" tabindex="-1"></a>Limpios <span class="ot">&lt;-</span> <span class="fu">subset</span>(datos, <span class="sc">!</span><span class="fu">is.na</span>(avg_do_raw) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(avg_wind_speed) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(avg_do_wtemp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(avg_par))</span></code></pre></div>
<p>Nosotros, de aquí, vamos a seleccionar un par de meses de 2005.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb69-1" aria-hidden="true" tabindex="-1"></a>Desde <span class="ot">&lt;-</span> <span class="st">&quot;2005-09-01&quot;</span></span>
<span id="cb69-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb69-2" aria-hidden="true" tabindex="-1"></a>Hasta <span class="ot">&lt;-</span> <span class="st">&quot;2005-10-31&quot;</span></span>
<span id="cb69-3"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Ahora seleccionamos el periodo en nuestro datos</span></span>
<span id="cb69-5"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb69-5" aria-hidden="true" tabindex="-1"></a>Periodo_sel <span class="ot">&lt;-</span> <span class="fu">subset</span>(Limpios, sampledate <span class="sc">&gt;=</span> Desde <span class="sc">&amp;</span> sampledate <span class="sc">&lt;=</span> Hasta)</span></code></pre></div>
<div id="función-metab-del-paquete-lakemetabolizer" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Función <code>metab()</code> del paquete LakeMetabolizer<a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#función-metab-del-paquete-lakemetabolizer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En primer lugar deberéis instalar el paquete y cargalo:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;LakeMetabolizer&quot;</span>)</span>
<span id="cb70-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LakeMetabolizer)</span></code></pre></div>
<p>Aquí tenéis información sobre el paquete:</p>
<p>1.<a href="https://cran.r-project.org/web/packages/LakeMetabolizer/LakeMetabolizer.pdf">Paquete info LakeMetabolizer</a>.</p>
<p>2.<a href="https://www.tandfonline.com/doi/pdf/10.1080/IW-6.4.883?needAccess=true">Artículo</a>.</p>
<p>La función que vamos a usar es <code>metab()</code>. Si queremos saber como usarla, lo que debemos hacer es preguntarle a R <code>?metab()</code>. En el apartado “Help” de Rstudio nos aparece la información necesaria sobre la función: Para qué se usa, cómo se usa, los argumentos que necesita y los valores que te devuelve.</p>
<p>Si echamos un vistazo a los argumentos vemos que la información que necesitamos es la siguiente:</p>
<ol style="list-style-type: decimal">
<li>Oxígeno disuelto en mg/L. Para obtener un buena estima del metabolismo lo ideal sería de disponer de una medida de oxígeno al menos cada 30 minutos <span class="citation">(<a href="#ref-Staehr2010" role="doc-biblioref">Staehr et al. 2010</a>)</span>.</li>
<li>Concentración de oxígeno disuelto (mg/L) que tendría el agua si estuviera saturada al 100%.</li>
<li>Coeficiente de intercambio gaseoso en m/día.</li>
<li>Profundidad de la capa de mezcla en m.</li>
<li>Irradiancia.</li>
<li>Temperatura del agua.</li>
</ol>
<p>Si revisamos la información de la que disponemos vemos que algunas de ellas ya las tenemos: oxígeno disuelto (avg_do_raw), irradiancia (avg_par) y temperatura del agua (avg_do_wtemp). Sin embargo, no disponemos de todas. Por lo tanto, vamos a intentar obtenerlas todas y, más tarde, cuando las tengamos todas, volveremos de nuevo a la función <code>metab()</code>.</p>
<div id="concentración-de-oxígeno-en-saturación." class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Concentración de oxígeno en saturación.<a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#concentración-de-oxígeno-en-saturación." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para calcular la concentración de oxígeno en saturación, el mismo paquete LakeMetabolizer nos provee una función denominada <code>o2.at.sat()</code>. Lo primero que hacemos es ver como funciona <code>?o2.at.sat()</code>. Vemos que necesitamos un data.frame con dos columnas, una con la fecha y la hora (datetime) y otra con la temperatura del agua en <span class="math inline">\(^oC\)</span> (wtr). Además, tenemos la opción de introducir la presión barométrica en milibares o la altitud en metros a la que se encuentra el lago. Aunque en nuestros datos tenemos una variable que corresponde con la presión atmosférica parece, por desgracia, que no disponemos de datos para el periodo seleccionado. Bueno, en su lugar podemos usar la altitud a la que se encuentra el lago que sabemos que es de 492 m (<a href="https://lter.limnology.wisc.edu/researchsite/trout-lake">Info Trout Lake</a>). La salinidad está por defecto en 0, así que como nuestro lago es de agua dulce no debemos cambiarla.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb71-1" aria-hidden="true" tabindex="-1"></a> saturacion <span class="ot">&lt;-</span> Periodo_sel[,<span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>,<span class="st">&quot;avg_do_wtemp&quot;</span>)] <span class="co">#Creamos un data.frame con las dos variables que necesitamos</span></span>
<span id="cb71-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb71-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">colnames</span>(saturacion) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>, <span class="st">&quot;wtr&quot;</span>) <span class="co">#Renombramos las columnas para que la función las reconozca automaticamente.</span></span>
<span id="cb71-3"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb71-3" aria-hidden="true" tabindex="-1"></a> results_sat  <span class="ot">&lt;-</span> <span class="fu">o2.at.sat</span>(saturacion, <span class="at">altitude =</span> <span class="dv">492</span>)</span></code></pre></div>
<p>Ya tenemos la concentración de oxígeno en saturación calculada, vamos a por la siguiente variable.</p>
</div>
<div id="coeficiente-de-intercambio-gaseoso" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Coeficiente de intercambio gaseoso<a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#coeficiente-de-intercambio-gaseoso" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para esto, el paquete LakeMetabolizer también dispone de un función que lo calcula <code>k600.2.kGAS()</code>. Pero para aplicar esta función antes debemos calcular k<sub>600</sub>.</p>
<div id="calcular-k600" class="section level4 hasAnchor" number="5.1.2.1">
<h4><span class="header-section-number">5.1.2.1</span> Calcular k<sub>600</sub><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#calcular-k600" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Si ejecutamos en la consola <code>?k.read()</code> podremos ver la distintas opciones que nos ofrece el paquete para calcular la k<sub>600</sub>. Nosotros vamos a usar el método que proponen <span class="citation">Cole and Caraco (<a href="#ref-Cole1998" role="doc-biblioref">1998</a>)</span>, para ello usamos la función <code>k.cole()</code>. Aquí, la información de la función está, cuanto menos, confusa. Para aplicar la función necesitamos un data.frame con dos columnas, una con la fecha y la hora (datetime) y otra con la velocidad del viento en m/s a 10 metros de altura (wnd). El sensor de “nuestra” boya registra la velocidad del viento a 2 m de altura <span class="citation">(<a href="#ref-Dugan2016" role="doc-biblioref">Dugan et al. 2016</a>)</span>, por lo tanto debemos calcular la velocidad del viento a 10 m. Para ello tambien tenemos una función disponible <code>wind.scale()</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb72-1" aria-hidden="true" tabindex="-1"></a>df_k <span class="ot">&lt;-</span> Periodo_sel[,<span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>,<span class="st">&quot;avg_wind_speed&quot;</span>)] <span class="co">#Creamos un objeto solo con las variables que nos interesan.</span></span>
<span id="cb72-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_k)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;wnd&quot;</span> <span class="co">#renombramos la columna con los datos de viento</span></span>
<span id="cb72-3"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculamos la velocidad del viento a 10 m</span></span>
<span id="cb72-4"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb72-4" aria-hidden="true" tabindex="-1"></a>df_k <span class="ot">&lt;-</span> <span class="fu">wind.scale</span>(df_k, <span class="at">wnd.z =</span> <span class="dv">2</span>)</span>
<span id="cb72-5"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_k)</span></code></pre></div>
<pre><code>##              datetime   wnd_10
## 1 2005-09-01 00:00:00 5.410463
## 2 2005-09-01 01:00:00 6.645322
## 3 2005-09-01 02:00:00 5.028548
## 4 2005-09-01 03:00:00 3.997377
## 5 2005-09-01 04:00:00 3.793689
## 6 2005-09-01 05:00:00 4.302909</code></pre>
<p>Ahora sí podemos calcular la k<sub>600</sub>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb74-1" aria-hidden="true" tabindex="-1"></a>k_600 <span class="ot">&lt;-</span> <span class="fu">k.cole</span>(df_k)</span>
<span id="cb74-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(k_600)</span></code></pre></div>
<pre><code>##              datetime      k600
## 1 2005-09-01 00:00:00 1.4070239
## 2 2005-09-01 01:00:00 1.7878020
## 3 2005-09-01 02:00:00 1.3005151
## 4 2005-09-01 03:00:00 1.0408859
## 5 2005-09-01 04:00:00 0.9945998
## 6 2005-09-01 05:00:00 1.1134595</code></pre>
<p>Una vez hemos calculado la k<sub>600</sub>, y teniendo la temperatura del agua, podemos calcular el coeficiente de intercambio gaseoso para el O<sub>2</sub>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Añadimos la variable temperatura</span></span>
<span id="cb76-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb76-2" aria-hidden="true" tabindex="-1"></a>k_600<span class="sc">$</span>wtr <span class="ot">&lt;-</span> Periodo_sel<span class="sc">$</span>avg_do_wtemp</span>
<span id="cb76-3"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb76-3" aria-hidden="true" tabindex="-1"></a>k_gas <span class="ot">&lt;-</span> <span class="fu">k600.2.kGAS</span>(k_600, <span class="at">gas =</span> <span class="st">&quot;O2&quot;</span>)</span></code></pre></div>
<p>Ahora juntamos todos los datos y los ordenamos. Aprovecho para presentaros el paquete <code>dplyr</code>. <a href="https://4.files.edl.io/b9e2/07/12/19/142839-a23788fb-1d3a-4665-9dc4-33bfd442c296.pdf">Aquí tenéis una visión general del paquete</a>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb77-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#juntamos todos los datos</span></span>
<span id="cb78-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb78-2" aria-hidden="true" tabindex="-1"></a>datos.ts <span class="ot">&lt;-</span> <span class="fu">merge</span>(Periodo_sel, results_sat) <span class="sc">%&gt;%</span> <span class="fu">merge</span>(k_gas)</span>
<span id="cb78-3"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#seleccionamos los que nos atañen.</span></span>
<span id="cb78-4"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb78-4" aria-hidden="true" tabindex="-1"></a>datos.ts <span class="ot">&lt;-</span> datos.ts[,<span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>, <span class="st">&quot;avg_do_raw&quot;</span>, <span class="st">&quot;do.sat&quot;</span>, <span class="st">&quot;k.gas&quot;</span>, <span class="st">&quot;avg_par&quot;</span>,<span class="st">&quot;avg_do_wtemp&quot;</span>)]</span>
<span id="cb78-5"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Renombramos las columnas de oxigeno, irradiancia y temperatura para que las interprete la función metab()</span></span>
<span id="cb78-6"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos.ts)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;do.obs&quot;</span>, <span class="st">&quot;irr&quot;</span>, <span class="st">&quot;wtr&quot;</span>)</span></code></pre></div>
<p>Además debemos añadir la profundidad de la termoclina. Nosotros no disponemos del perfil del temperatura (aún) por lo que no podemos saber donde se sitúa la termoclina, por lo tanto no nos queda más que asumir que el lago permanece mezclado durante todo el periodo.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb79-1" aria-hidden="true" tabindex="-1"></a>datos.ts<span class="sc">$</span>z.mix <span class="ot">&lt;-</span> <span class="dv">15</span></span></code></pre></div>
</div>
</div>
</div>
<div id="volvemos-a-la-función-metab" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Volvemos a la función <code>metab()</code><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#volvemos-a-la-función-metab" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bien, ya tenemos los datos que necesitamos ordenaditos en un data.frame, ahora podemos calcular el metabolismo. Para ello, la función nos ofrece 5 métodos para estimar el metabolismo. El más sencillo y el que menos asunciones toma, es el método ‘bookkeep’ <span class="citation">Odum (<a href="#ref-Odum1956" role="doc-biblioref">1956</a>)</span>, por lo tanto será el que usemos:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb80-1" aria-hidden="true" tabindex="-1"></a>Metabolismo <span class="ot">&lt;-</span> <span class="fu">metab</span>(datos.ts, <span class="at">method =</span> <span class="st">&quot;bookkeep&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Points removed due to incomplete day or duplicated time step: 48&quot;
## [1] &quot;NA&#39;s added to fill in time series: 0&quot;</code></pre>
<pre><code>## Error in metab.bookkeep(do.obs = c(8.07, 8.05, 8.02, 8.01, 8.06, 8.11, : either supply datetime &amp; lake.lat arguments, or supply irr as integer vector of 1&#39;s and 0&#39;s</code></pre>
<p>El modelo nos pide que le introduzcamos también la latitud a la que se encuentra el lago o que el vector irradiancia sea de 0 y 1 (noche o día), esto es porque el método “bookkeep” no usa ninguna relación entre GPP e irradiancia, por lo tanto sólo le sirve para saber cuando se es de día o de noche.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb83-1" aria-hidden="true" tabindex="-1"></a>Metabolismo_Trout <span class="ot">&lt;-</span> <span class="fu">metab</span>(datos.ts, <span class="at">lake.lat =</span> <span class="dv">46</span>, <span class="at">method =</span> <span class="st">&quot;bookkeep&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Points removed due to incomplete day or duplicated time step: 48&quot;
## [1] &quot;NA&#39;s added to fill in time series: 0&quot;</code></pre>
<p>No os preocupéis por este mensaje. Nos informa que cuando no tiene la información completa para un día no puede calcular el metabolismo para ese día, así que se lo salta y sigue con el siguiente.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Metabolismo_Trout)</span></code></pre></div>
<pre><code>##   year doy        GPP           R         NEP
## 1 2005 244 0.16177941 -0.10095561  0.01957457
## 2 2005 245 0.25551422 -0.29238301 -0.16559482
## 3 2005 246 0.07526482  0.01752214  0.10443949
## 4 2005 247 0.12384506 -0.11163144 -0.03579075
## 5 2005 248 0.27890580 -0.21474973 -0.02642397
## 6 2005 249 0.23568249 -0.26489782 -0.14565852</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Metabolismo_Trout)</span></code></pre></div>
<pre><code>##       year           doy             GPP                R          
##  Min.   :2005   Min.   :244.0   Min.   :-0.8299   Min.   :-1.6411  
##  1st Qu.:2005   1st Qu.:258.5   1st Qu.: 0.1738   1st Qu.:-0.3120  
##  Median :2005   Median :273.0   Median : 0.2640   Median :-0.2143  
##  Mean   :2005   Mean   :273.0   Mean   : 0.2945   Mean   :-0.2311  
##  3rd Qu.:2005   3rd Qu.:287.5   3rd Qu.: 0.3763   3rd Qu.:-0.1210  
##  Max.   :2005   Max.   :302.0   Max.   : 1.8408   Max.   : 0.5316  
##       NEP          
##  Min.   :-0.55284  
##  1st Qu.:-0.13305  
##  Median :-0.05037  
##  Mean   :-0.04596  
##  3rd Qu.: 0.01869  
##  Max.   : 0.61800</code></pre>
<p>Ahora sí, ya hemos calculado el metabolismo (GPP, R y NEP) en el lago Trout durante el periodo de junio-octubre 2018. Con el paquete <code>ggplot2</code> podemos comenzar a explorar los datos.</p>
<p>También podemos guardar los resultados en la carpeta “Datos” para trabajar con ellos en otro momento.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(datos.ts, <span class="st">&quot;./Datos/datos_ts_2005.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-2"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Metabolismo_Trout, <span class="st">&quot;./Datos/Metabolismo_Trout.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>

</div>
</div>
<h3>Referencias<a href="referencias.html#referencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Cole1998" class="csl-entry">
Cole, J. J., and N. F. Caraco. 1998. <a href="https://doi.org/10.4319/lo.1998.43.4.0647"><span class="nocase">Atmospheric exchange of carbon dioxide in a low-wind oligotrophic lake measured by the addition of SF 6</span></a>. Limnology and Oceanography <strong>43</strong>: 647–656.
</div>
<div id="ref-Dugan2016" class="csl-entry">
Dugan, H. A., R. Iestyn Woolway, A. B. Santoso, J. R. Corman, A. Jaimes, E. R. Nodine, V. P. Patil, J. A. Zwart, J. A. Brentrup, A. L. Hetherington, S. K. Oliver, J. S. Read, K. M. Winters, P. C. Hanson, E. K. Read, L. A. Winslow, and K. C. Weathers. 2016. <a href="https://doi.org/10.5268/IW-6.4.836"><span class="nocase">Consequences of gas flux model choice on the interpretation of metabolic balance across 15 lakes</span></a>. Inland Waters <strong>6</strong>: 581–592.
</div>
<div id="ref-Odum1956" class="csl-entry">
Odum, H. T. 1956. <span class="nocase">Primary Production in Flowing Waters</span>. Limnology and Oceanography 102–117.
</div>
<div id="ref-Staehr2010" class="csl-entry">
Staehr, P. a., D. Bade, G. R. Koch, C. Williamson, P. Hanson, J. J. Cole, and T. Kratz. 2010. <a href="https://doi.org/10.4319/lom.2010.8.628"><span class="nocase">Lake metabolism and the diel oxygen technique: State of the science</span></a>. Limnology and Oceanography: Methods <strong>8</strong>: 628–644.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descargar-los-datos-de-la-red-gleon.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estabilidad-térmica-de-la-columna-de-agua..html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
