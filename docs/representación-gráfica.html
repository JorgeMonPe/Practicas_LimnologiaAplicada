<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Representación gráfica | Prácticas de Limnología Aplicada</title>
  <meta name="description" content="En este documento abordaremos las prácticas de informática de la asignatura de Limnología Aplicada." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Representación gráfica | Prácticas de Limnología Aplicada" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="En este documento abordaremos las prácticas de informática de la asignatura de Limnología Aplicada." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Representación gráfica | Prácticas de Limnología Aplicada" />
  
  <meta name="twitter:description" content="En este documento abordaremos las prácticas de informática de la asignatura de Limnología Aplicada." />
  

<meta name="author" content="Jorge Juan Montes Pérez (jmontesp@uma.es)" />


<meta name="date" content="2023-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estabilidad-térmica-de-la-columna-de-agua..html"/>
<link rel="next" href="recopilamos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);

</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);

</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan, pre.js');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);

</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Limnología Aplicada</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>¿Cómo seguir la práctica?</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html#metabolismo-de-ecosistemas-acuáticos"><i class="fa fa-check"></i><b>1.1</b> Metabolismo de ecosistemas acuáticos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="estructura-de-la-práctica.html"><a href="estructura-de-la-práctica.html"><i class="fa fa-check"></i><b>2</b> Estructura de la práctica</a></li>
<li class="chapter" data-level="3" data-path="previsualización-de-los-datos.html"><a href="previsualización-de-los-datos.html"><i class="fa fa-check"></i><b>3</b> Previsualización de los datos</a></li>
<li class="chapter" data-level="4" data-path="descargar-los-datos-de-la-red-gleon.html"><a href="descargar-los-datos-de-la-red-gleon.html"><i class="fa fa-check"></i><b>4</b> Descargar los datos de la red GLEON</a></li>
<li class="chapter" data-level="5" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html"><i class="fa fa-check"></i><b>5</b> Estima del metabolismo del metabolismo aeróbico.</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#función-metab-del-paquete-lakemetabolizer"><i class="fa fa-check"></i><b>5.1</b> Función <code>metab()</code> del paquete LakeMetabolizer</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#concentración-de-oxígeno-en-saturación."><i class="fa fa-check"></i><b>5.1.1</b> Concentración de oxígeno en saturación.</a></li>
<li class="chapter" data-level="5.1.2" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#coeficiente-de-intercambio-gaseoso"><i class="fa fa-check"></i><b>5.1.2</b> Coeficiente de intercambio gaseoso</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estima-del-metabolismo-del-metabolismo-aeróbico..html"><a href="estima-del-metabolismo-del-metabolismo-aeróbico..html#volvemos-a-la-función-metab"><i class="fa fa-check"></i><b>5.2</b> Volvemos a la función <code>metab()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estabilidad-térmica-de-la-columna-de-agua..html"><a href="estabilidad-térmica-de-la-columna-de-agua..html"><i class="fa fa-check"></i><b>6</b> Estabilidad térmica de la columna de agua.</a></li>
<li class="chapter" data-level="7" data-path="representación-gráfica.html"><a href="representación-gráfica.html"><i class="fa fa-check"></i><b>7</b> Representación gráfica</a>
<ul>
<li class="chapter" data-level="7.1" data-path="representación-gráfica.html"><a href="representación-gráfica.html#variables-físico-químicas"><i class="fa fa-check"></i><b>7.1</b> Variables físico-químicas</a></li>
<li class="chapter" data-level="7.2" data-path="representación-gráfica.html"><a href="representación-gráfica.html#estructura-térmica-del-lago."><i class="fa fa-check"></i><b>7.2</b> Estructura térmica del lago.</a></li>
<li class="chapter" data-level="7.3" data-path="representación-gráfica.html"><a href="representación-gráfica.html#resultados-del-metabolismo"><i class="fa fa-check"></i><b>7.3</b> Resultados del metabolismo</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="recopilamos.html"><a href="recopilamos.html"><i class="fa fa-check"></i><b>8</b> Recopilamos</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/" target="blank">Realizado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Limnología Aplicada</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="representación-gráfica" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Representación gráfica<a href="representación-gráfica.html#representación-gráfica" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Después de algunas peleas con los datos y, porqué no ser sinceros, con el maldito-bendito R, ya tenemos suficiente información sobre el lago Trout. El siguiente paso es representar gráficamente esta información para poder interpretar mejor los resultados y comunicarlos de forma efectiva al resto de compañerxs. El paquete estrella de R para esta tarea, ya lo conocéis, es <code>ggplot2</code>.</p>
<p>Antes de empezar vamos a cargar todos los datos que necesitaremos.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="representación-gráfica.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos iniciales</span></span>
<span id="cb101-2"><a href="representación-gráfica.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  datos.ts <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">&quot;./Datos/datos_ts_2005_zmix.csv&quot;</span>)</span>
<span id="cb101-3"><a href="representación-gráfica.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  datos.ts<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(datos.ts<span class="sc">$</span>datetime)</span>
<span id="cb101-4"><a href="representación-gráfica.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos temperatura</span></span>
<span id="cb101-5"><a href="representación-gráfica.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  Perfiles_temp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Datos/Perfiles_temp.csv&quot;</span>)</span>
<span id="cb101-6"><a href="representación-gráfica.html#cb101-6" aria-hidden="true" tabindex="-1"></a>  Perfiles_temp<span class="sc">$</span>sampledate <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(Perfiles_temp<span class="sc">$</span>sampledate)</span>
<span id="cb101-7"><a href="representación-gráfica.html#cb101-7" aria-hidden="true" tabindex="-1"></a>  Perfiles_temp<span class="sc">$</span>datetime<span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(Perfiles_temp<span class="sc">$</span>datetime)</span>
<span id="cb101-8"><a href="representación-gráfica.html#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos metabolismo</span></span>
<span id="cb101-9"><a href="representación-gráfica.html#cb101-9" aria-hidden="true" tabindex="-1"></a>  datos_metab <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Datos/Metabolismo_Trout.csv&quot;</span>)</span></code></pre></div>
<div id="variables-físico-químicas" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Variables físico-químicas<a href="representación-gráfica.html#variables-físico-químicas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lo primero que vamos a hacer es generar algunas sencillas gráficas para ver el estado del lago durante el periodo que hemos seleccionado.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="representación-gráfica.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb102-2"><a href="representación-gráfica.html#cb102-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(datos.ts, <span class="fu">aes</span>(<span class="at">x=</span>datetime, <span class="at">y=</span>do.obs))<span class="sc">+</span></span>
<span id="cb102-3"><a href="representación-gráfica.html#cb102-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="100%" /></p>
<p>Podemos repetir esta gráfica para cada una de las variables que tenemos o podemos servirnos del paquete <code>reshape2</code> y convertir la tabla de datos a forma “largo” y usar una capa para que haga una gráfica por cada variable.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="representación-gráfica.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb103-2"><a href="representación-gráfica.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Convertimos la tabla a formato largo</span></span>
<span id="cb103-3"><a href="representación-gráfica.html#cb103-3" aria-hidden="true" tabindex="-1"></a>datos.ts_l <span class="ot">&lt;-</span> <span class="fu">melt</span>(datos.ts, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>) , <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">&#39;variable&#39;</span>), <span class="at">value.name =</span> <span class="st">&#39;valor&#39;</span>)</span>
<span id="cb103-4"><a href="representación-gráfica.html#cb103-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb103-5"><a href="representación-gráfica.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Representamos</span></span>
<span id="cb103-6"><a href="representación-gráfica.html#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(datos.ts_l, <span class="fu">aes</span>(<span class="at">x =</span> datetime, <span class="at">y =</span> valor))<span class="sc">+</span></span>
<span id="cb103-7"><a href="representación-gráfica.html#cb103-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb103-8"><a href="representación-gráfica.html#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="100%" /></p>
<p>También podríamos, por ejemplo, querer hacer un “zoom” a solo unos días para ver si existen tendencencias diarias.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="representación-gráfica.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="representación-gráfica.html#cb107-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">subset</span>(datos.ts_l, <span class="fu">date</span>(datetime) <span class="sc">&gt;=</span> <span class="st">&quot;2005-09-05&quot;</span> <span class="sc">&amp;</span> <span class="fu">date</span>(datetime) <span class="sc">&lt;=</span> <span class="st">&quot;2005-09-07&quot;</span>), <span class="fu">aes</span>(<span class="at">x =</span> datetime, <span class="at">y =</span> valor))<span class="sc">+</span></span>
<span id="cb107-2"><a href="representación-gráfica.html#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb107-3"><a href="representación-gráfica.html#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb107-4"><a href="representación-gráfica.html#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_datetime</span>(<span class="at">date_labels =</span> <span class="st">&quot;%R&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="100%" /></p>
<p>Vamos a modificar un poco el aspecto de las gráficas anteriores antes de pasar las siguientes:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="representación-gráfica.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Podemos usar un &quot;theme&quot; prediseñado</span></span>
<span id="cb108-2"><a href="representación-gráfica.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  Grafica_vars <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.ts_l, <span class="fu">aes</span>(<span class="at">x =</span> datetime, <span class="at">y =</span> valor))<span class="sc">+</span></span>
<span id="cb108-3"><a href="representación-gráfica.html#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb108-4"><a href="representación-gráfica.html#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb108-5"><a href="representación-gráfica.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb108-6"><a href="representación-gráfica.html#cb108-6" aria-hidden="true" tabindex="-1"></a>  Grafica_vars <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">&quot;Times&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="100%" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="representación-gráfica.html#cb109-1" aria-hidden="true" tabindex="-1"></a>  Grafica_vars <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-2.png" width="100%" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="representación-gráfica.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Y luego cambiar algunos aspecto del &quot;theme&quot; de la gráfica usando:  %+replace% theme(axis.title = element_blank(), strip.background = element_blank())</span></span>
<span id="cb110-2"><a href="representación-gráfica.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="representación-gráfica.html#cb110-3" aria-hidden="true" tabindex="-1"></a>    Grafica_vars <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">&quot;Times&quot;</span>)<span class="sc">%+replace%</span> <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="at">strip.background =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-3.png" width="100%" /></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="representación-gráfica.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#También podemos modificar el &quot;theme&quot; directamente a nuestro gusto</span></span>
<span id="cb111-2"><a href="representación-gráfica.html#cb111-2" aria-hidden="true" tabindex="-1"></a>Grafica_vars <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-4.png" width="100%" /></p>
<p>Una vez que tenemos el aspecto que deseamos de nuestra gráfica, la guardamos y la exportamos, a la carpeta que creamos llamada “Graficas”, para poder usarla en cualquier documento en el que estemos trabajando.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="representación-gráfica.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Guardamos</span></span>
<span id="cb112-2"><a href="representación-gráfica.html#cb112-2" aria-hidden="true" tabindex="-1"></a>Grafica_vars_exp <span class="ot">&lt;-</span> Grafica_vars <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb112-3"><a href="representación-gráfica.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Exportamos</span></span>
<span id="cb112-4"><a href="representación-gráfica.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./Graficas/Grafica_variables.png&quot;</span>, Grafica_vars_exp, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
</div>
<div id="estructura-térmica-del-lago." class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Estructura térmica del lago.<a href="representación-gráfica.html#estructura-térmica-del-lago." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como finalmente conseguimos encontrar datos de la temperatura del lago a distintas profundidades sería interesante realizar una gráfica de contorno del periodo estudiado. Estas gráficas son muy visuales y ayudan a entender mejor el comportamiento del lago. Las vemos a menudo en los artículos.</p>
<div class="figure">
<img src="Imagen_ContourPlot.png" alt="" />
<p class="caption">Imagen ejemplo de gráfica de contorno extraída de <span class="citation">Vidal et al. (<a href="#ref-Vidal2010" role="doc-biblioref">2010</a>)</span></p>
</div>
<p>Existen distintos programas que permiten hacer estas gráficas como son Surfer, SigmaPlot o OceanDataView, con el inconveniente que la mayoría de ellos son privativos y de pago (OceanDataView se salva!). Además, ya que estamos metidos en harina porque no hacerlo todo con el mismo programa. R nos permite trabajar desde los datos crudos hasta la generación de gráficas e informes (estos documentos están hechos directamente desde R).</p>
<p>Vamos a partir de la tabla de datos en formato “ancho” que creamos para calcular la profundidad de la capa de mezcla.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="representación-gráfica.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb113-2"><a href="representación-gráfica.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Así creamos el archivo</span></span>
<span id="cb113-3"><a href="representación-gráfica.html#cb113-3" aria-hidden="true" tabindex="-1"></a>dt_wtemp <span class="ot">&lt;-</span> <span class="fu">dcast</span>(Perfiles_temp, datetime <span class="sc">~</span> depth, <span class="at">value.var =</span> <span class="st">&quot;wtemp&quot;</span>)</span>
<span id="cb113-4"><a href="representación-gráfica.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Renombramos las columnas según nos pide la función</span></span>
<span id="cb113-5"><a href="representación-gráfica.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dt_wtemp)[<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;wtr&quot;</span>, <span class="fu">colnames</span>(dt_wtemp)[<span class="sc">-</span><span class="dv">1</span>], <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>)</span></code></pre></div>
<p>Al transformar el objeto a formato “ancho” hemos homogeneizado las profundidades a las que tenemos datos de temperatura. Es decir, tenemos el mismo número de medidas y a las mismas profundidades para cada momento. Sin embargo, como los datos no estaban completos se han introducidos NAs en aquellas profundidades donde no teníamos información. Por ejemplo, en el perfil de las 1:00 am del 205-09-01, tenemos datos de temperatura a 11.5 y a 12.5 metros pero no a 12 m. Para solucionar esto, podemos interpolar los datos.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="representación-gráfica.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="representación-gráfica.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Interpolamos</span></span>
<span id="cb117-2"><a href="representación-gráfica.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  dt_wtemp[,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(dt_wtemp[,<span class="sc">-</span><span class="dv">1</span>],<span class="at">rule =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Ahora podemos devolver los datos a su formato largo.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="representación-gráfica.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb118-2"><a href="representación-gráfica.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  Per_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(dt_wtemp, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>))</span>
<span id="cb118-3"><a href="representación-gráfica.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  Per_melt<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">parse_number</span>(<span class="fu">as.character</span>(Per_melt<span class="sc">$</span>variable))</span>
<span id="cb118-4"><a href="representación-gráfica.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(Per_melt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>, <span class="st">&quot;depth&quot;</span>, <span class="st">&quot;wtemp&quot;</span>)</span></code></pre></div>
<p>E intentamos representar.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="representación-gráfica.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Per_melt, <span class="fu">aes</span>(<span class="at">x =</span> datetime, <span class="at">y =</span> depth, <span class="at">color =</span> wtemp))<span class="sc">+</span></span>
<span id="cb119-2"><a href="representación-gráfica.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-45-1.png" width="100%" /></p>
<p>Parece que estamos bastante cerca, sin embargo, hay muchos huecos en blanco. Para solucionar esto vamos a crear una matriz y a usar una interpolación espacial multinivel b-spline para completar la información que nos falta.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="representación-gráfica.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb120-2"><a href="representación-gráfica.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Primero tenemos que convertir las fechas en un vector numérico</span></span>
<span id="cb120-3"><a href="representación-gráfica.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  Per_melt<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">decimal_date</span>(Per_melt<span class="sc">$</span>datetime)</span>
<span id="cb120-4"><a href="representación-gráfica.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MBA)</span>
<span id="cb120-5"><a href="representación-gráfica.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Aquí creamos una matriz con mayor resolución usando una interpolación espacial multinivel b-spline</span></span>
<span id="cb120-6"><a href="representación-gráfica.html#cb120-6" aria-hidden="true" tabindex="-1"></a>Temp_mba <span class="ot">&lt;-</span> <span class="fu">mba.surf</span>(Per_melt, <span class="at">no.X =</span> <span class="dv">500</span>, <span class="at">no.Y =</span> <span class="dv">500</span>, <span class="at">extend =</span> T)</span>
<span id="cb120-7"><a href="representación-gráfica.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Aquí están las fecha con la nueva resolución (en este caso es menor de la que teniamos, 500 &quot;perfiles&quot;, frente a los 1464 que teníamos, pero no necesitamos más)</span></span>
<span id="cb120-8"><a href="representación-gráfica.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>## [1] 2005.666 2005.666 2005.666 2005.667 2005.667 2005.667</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="representación-gráfica.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Aquí tenemos las nuevas profundidades, 500 profundidades en lugar de las 27 que teniamos antes</span></span>
<span id="cb122-2"><a href="representación-gráfica.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.00000000 0.06212425 0.12424850 0.18637275 0.24849699 0.31062124</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="representación-gráfica.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estos son los datos de temperatura</span></span>
<span id="cb124-2"><a href="representación-gráfica.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>z)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] 20.25121 20.22306 20.17375 20.10752 20.02856 19.94159 20.23992 20.21190
##  [9] 20.16351 20.09884</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="representación-gráfica.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Los juntamos todos</span></span>
<span id="cb126-2"><a href="representación-gráfica.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>z) <span class="ot">&lt;-</span> <span class="fu">list</span>(Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>x, Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>y)</span>
<span id="cb126-3"><a href="representación-gráfica.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Y los volvemos al formato largo.</span></span>
<span id="cb126-4"><a href="representación-gráfica.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb126-5"><a href="representación-gráfica.html#cb126-5" aria-hidden="true" tabindex="-1"></a>Temp_mba <span class="ot">&lt;-</span> <span class="fu">melt</span>(Temp_mba<span class="sc">$</span>xyz.est<span class="sc">$</span>z, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">&#39;date&#39;</span>, <span class="st">&#39;depth&#39;</span>), <span class="at">value.name =</span> <span class="st">&#39;temp&#39;</span>) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">round</span>(temp, <span class="dv">3</span>))</span>
<span id="cb126-6"><a href="representación-gráfica.html#cb126-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-7"><a href="representación-gráfica.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Esta es la pinta de los datos:</span></span>
<span id="cb126-8"><a href="representación-gráfica.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Temp_mba)</span></code></pre></div>
<pre><code>##       date depth   temp
## 1 2005.666     0 20.251
## 2 2005.666     0 20.223
## 3 2005.666     0 20.174
## 4 2005.667     0 20.108
## 5 2005.667     0 20.029
## 6 2005.667     0 19.942</code></pre>
<p>Ahora representamos de nuevo.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="representación-gráfica.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Temp_mba, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> depth, <span class="at">color =</span> temp))<span class="sc">+</span></span>
<span id="cb128-2"><a href="representación-gráfica.html#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-1.png" width="100%" /></p>
<p>¡Mucho mejor! Vamos a cambiar algunos aspectos estéticos para que quede más resultona.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="representación-gráfica.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Vamos a devolverle el formato de fecha</span></span>
<span id="cb129-2"><a href="representación-gráfica.html#cb129-2" aria-hidden="true" tabindex="-1"></a>Temp_mba<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">date_decimal</span>(Temp_mba<span class="sc">$</span>date)</span>
<span id="cb129-3"><a href="representación-gráfica.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Cargamos un paquete para usar una paleta de color má común</span></span>
<span id="cb129-4"><a href="representación-gráfica.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorRamps)</span>
<span id="cb129-5"><a href="representación-gráfica.html#cb129-5" aria-hidden="true" tabindex="-1"></a>Grafica_temp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> Temp_mba, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> depth)) <span class="sc">+</span></span>
<span id="cb129-6"><a href="representación-gráfica.html#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> temp)) <span class="sc">+</span> <span class="co">#Usamos esta capa que viene mejor para este tipo de gráficos pero podíamos haber usado geom_point</span></span>
<span id="cb129-7"><a href="representación-gráfica.html#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb129-8"><a href="representación-gráfica.html#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">matlab.like2</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb129-9"><a href="representación-gráfica.html#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> temp), <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb129-10"><a href="representación-gráfica.html#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Profundidad (m)&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">&quot;temp. (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb129-11"><a href="representación-gráfica.html#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="dv">0</span>)</span>
<span id="cb129-12"><a href="representación-gráfica.html#cb129-12" aria-hidden="true" tabindex="-1"></a>Grafica_temp</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="100%" /></p>
<p>Hemos cambiado el formato de la fecha, hemos invertido el eje profundidad para que se más intuitivo, hemos cambiado las etiquetas, el color y añadido unas lineas de contorno.</p>
<p>Vamos a probar a añadirle la profundidad de la capa de mezcla.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="representación-gráfica.html#cb130-1" aria-hidden="true" tabindex="-1"></a>  Grafica_temp_zmix <span class="ot">&lt;-</span> Grafica_temp <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> datos.ts, <span class="fu">aes</span>(<span class="at">x=</span>datetime, <span class="at">y =</span> z.mix, <span class="at">color =</span> <span class="st">&quot;Capa mezcla&quot;</span>), <span class="at">size =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb130-2"><a href="representación-gráfica.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="cn">NULL</span>)</span>
<span id="cb130-3"><a href="representación-gráfica.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-4"><a href="representación-gráfica.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  Grafica_temp_zmix</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" width="100%" /></p>
<p>Y ya la tenemos lista para exportar.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="representación-gráfica.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./Graficas/Grafica_temp.png&quot;</span>, Grafica_temp_zmix, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
</div>
<div id="resultados-del-metabolismo" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Resultados del metabolismo<a href="representación-gráfica.html#resultados-del-metabolismo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Por último, vamos a representar los resultados que hemos obtenido del metabolismo del lago Trout. Como hemos hecho anteriormente convertimos los datos a formato “largo” y representamos.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="representación-gráfica.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transformamos</span></span>
<span id="cb132-2"><a href="representación-gráfica.html#cb132-2" aria-hidden="true" tabindex="-1"></a>datos_metab_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(datos_metab, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;doy&quot;</span>))</span>
<span id="cb132-3"><a href="representación-gráfica.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Vamos a crear una variable fecha que convierta el día del año (doy) en dia mes y año</span></span>
<span id="cb132-4"><a href="representación-gráfica.html#cb132-4" aria-hidden="true" tabindex="-1"></a>datos_metab_long<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(datos_metab_long<span class="sc">$</span>doy, <span class="at">origin =</span> <span class="st">&quot;2004-12-31&quot;</span>)</span>
<span id="cb132-5"><a href="representación-gráfica.html#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="representación-gráfica.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#representamos </span></span>
<span id="cb132-7"><a href="representación-gráfica.html#cb132-7" aria-hidden="true" tabindex="-1"></a>Grafica_metab <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_metab_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">color =</span> variable))<span class="sc">+</span></span>
<span id="cb132-8"><a href="representación-gráfica.html#cb132-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>()</span>
<span id="cb132-9"><a href="representación-gráfica.html#cb132-9" aria-hidden="true" tabindex="-1"></a>Grafica_metab</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-51-1.png" width="100%" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="representación-gráfica.html#cb133-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#vamos a modificar un poco los aspectos estéticos</span></span>
<span id="cb133-2"><a href="representación-gráfica.html#cb133-2" aria-hidden="true" tabindex="-1"></a> Grafica_metab <span class="ot">&lt;-</span> Grafica_metab <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Green&quot;</span>, <span class="st">&quot;Brown&quot;</span>, <span class="st">&quot;Darkgreen&quot;</span>))<span class="sc">+</span></span>
<span id="cb133-3"><a href="representación-gráfica.html#cb133-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;mg O&quot;</span>[<span class="dv">2</span>], <span class="st">&quot;·L&quot;</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>},<span class="st">&quot;día&quot;</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)), <span class="at">color =</span> <span class="cn">NULL</span> )<span class="sc">+</span></span>
<span id="cb133-4"><a href="representación-gráfica.html#cb133-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">&quot;Times&quot;</span>)</span>
<span id="cb133-5"><a href="representación-gráfica.html#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="representación-gráfica.html#cb133-6" aria-hidden="true" tabindex="-1"></a> Grafica_metab</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-51-2.png" width="100%" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="representación-gráfica.html#cb134-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#La exportamos</span></span>
<span id="cb134-2"><a href="representación-gráfica.html#cb134-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggsave</span>(<span class="st">&quot;./Graficas/Metabolismo_Trout_sept-oct.png&quot;</span>, Grafica_metab, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
<p>Si queremos obtener una visión global del metabolismo durante todo el periodo estudiado podemos probar con un tipo de gráfica de cajas y bigotes.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="representación-gráfica.html#cb135-1" aria-hidden="true" tabindex="-1"></a>  Grafica_metab_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_metab_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value))<span class="sc">+</span></span>
<span id="cb135-2"><a href="representación-gráfica.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb135-3"><a href="representación-gráfica.html#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="representación-gráfica.html#cb135-4" aria-hidden="true" tabindex="-1"></a>Grafica_metab_boxplot</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="100%" /></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="representación-gráfica.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Vamos a mejorarla un poco estéticamente.  </span></span>
<span id="cb136-2"><a href="representación-gráfica.html#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="representación-gráfica.html#cb136-3" aria-hidden="true" tabindex="-1"></a>Grafica_metab_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_metab_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable))<span class="sc">+</span></span>
<span id="cb136-4"><a href="representación-gráfica.html#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb136-5"><a href="representación-gráfica.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Green&quot;</span>, <span class="st">&quot;Brown&quot;</span>, <span class="st">&quot;Darkgreen&quot;</span>))<span class="sc">+</span></span>
<span id="cb136-6"><a href="representación-gráfica.html#cb136-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;mg O&quot;</span>[<span class="dv">2</span>], <span class="st">&quot;·L&quot;</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>},<span class="st">&quot;día&quot;</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)), <span class="at">fill =</span> <span class="cn">NULL</span> )<span class="sc">+</span></span>
<span id="cb136-7"><a href="representación-gráfica.html#cb136-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">&quot;Times&quot;</span>)</span>
<span id="cb136-8"><a href="representación-gráfica.html#cb136-8" aria-hidden="true" tabindex="-1"></a>  Grafica_metab_boxplot</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-2.png" width="100%" /></p>
<p>Esta es un representación más transparente de nuestros datos, en la que podemos ver la mediana (la linea), los cuartiles 1 y 4 (los límites de la caja) y los valores que se salen del rango. Sin embargo, sé que nos han acostumbrado a representar la media y la desviación estándar. Como os puede ser de utilidad en el futuro (no tan lejano, para el TFM por ejemplo) vamos a ver como hacerlo.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="representación-gráfica.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Primero debemos calcular la media y la desviación estándar</span></span>
<span id="cb137-2"><a href="representación-gráfica.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="representación-gráfica.html#cb143-1" aria-hidden="true" tabindex="-1"></a>  Metab_mSd <span class="ot">&lt;-</span> <span class="fu">ddply</span>(datos_metab_long, <span class="sc">~</span>variable, summarize, <span class="at">Media =</span> <span class="fu">mean</span>(value), <span class="at">Sd =</span> <span class="fu">sd</span>(value))</span>
<span id="cb143-2"><a href="representación-gráfica.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Aquí lo tenemos</span></span>
<span id="cb143-3"><a href="representación-gráfica.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  Metab_mSd</span></code></pre></div>
<pre><code>##   variable       Media        Sd
## 1      GPP  0.30275860 0.3286279
## 2        R -0.24464004 0.2912254
## 3      NEP -0.05776527 0.1970150</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="representación-gráfica.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Y luego lo representamos</span></span>
<span id="cb145-2"><a href="representación-gráfica.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Metab_mSd, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> Media))<span class="sc">+</span></span>
<span id="cb145-3"><a href="representación-gráfica.html#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb145-4"><a href="representación-gráfica.html#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Media<span class="sc">-</span>Sd, <span class="at">ymax =</span> Media<span class="sc">+</span>Sd))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="100%" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="representación-gráfica.html#cb146-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Vamos a cambiar algunos aspectos estéticos</span></span>
<span id="cb146-2"><a href="representación-gráfica.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  Grafica_metab_mSd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Metab_mSd, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> Media))<span class="sc">+</span></span>
<span id="cb146-3"><a href="representación-gráfica.html#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb146-4"><a href="representación-gráfica.html#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Media<span class="sc">-</span>Sd, <span class="at">ymax =</span> Media<span class="sc">+</span>Sd), <span class="at">width =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb146-5"><a href="representación-gráfica.html#cb146-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;mg O&quot;</span>[<span class="dv">2</span>], <span class="st">&quot;·L&quot;</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>},<span class="st">&quot;día&quot;</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)))<span class="sc">+</span></span>
<span id="cb146-6"><a href="representación-gráfica.html#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">&quot;Times&quot;</span>)</span>
<span id="cb146-7"><a href="representación-gráfica.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  Grafica_metab_mSd</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-2.png" width="100%" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="representación-gráfica.html#cb147-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Y exportamos</span></span>
<span id="cb147-2"><a href="representación-gráfica.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">&quot;./Graficas/Grafica_metab_mSd.png&quot;</span>, Grafica_metab_mSd, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
<p>Una vez ya tenéis los datos más importantes organizados y representados y las estimas del metabolismo calculadas tocaría, con los conocimientos teóricos de los que disponéis, interpretar esta información.</p>

</div>
</div>
<h3>Referencias<a href="referencias.html#referencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Vidal2010" class="csl-entry">
Vidal, J., E. Moreno-Ostos, C. Escot, R. Quesada, and F. Rueda. 2010. <a href="https://doi.org/10.1111/j.1365-2427.2010.02428.x"><span class="nocase">The effects of diel changes in circulation and mixing on the longitudinal distribution of phytoplankton in a canyon-shaped Mediterranean reservoir</span></a>. Freshwater Biology <strong>55</strong>: 1945–1957.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estabilidad-térmica-de-la-columna-de-agua..html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="recopilamos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
